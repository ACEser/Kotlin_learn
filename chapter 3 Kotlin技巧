class setflod(var name:String, var score:Double){
    fun do2(){println("$name is $score")}
}
//æ³¨æ„å¼•ç”¨å¯¹è±¡è¿™é‡Œä¹Ÿè¦åŠ ä¸€ä¸ªé—®å·
fun print(setflog:setflod?){
    setflog?.let{
        setflog.do2()
    }
}
fun main2() {
    val kotlin = "ğŸ™‚"
    println(kotlin)
    //å¤ä¹ ä¸€ä¸‹letï¼Œæ˜¯ç»™å¯¹è±¡ä¹‹é—´ç”¨çš„ï¼Œä»£ç é€»è¾‘æ˜¯ obj.let { obj2 -> ç¼–å†™å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ }
    //ä¸»è¦çš„ä½œç”¨å°±æ˜¯ç»“åˆï¼Ÿä¸ç”¨é‡å¤åˆ¤ç©º,å•ä¸ªå‡½æ•°å¥½åƒä¸éœ€è¦åˆ¤ç©ºï¼Œ
    //å› ä¸ºç›´æ¥ä¸ä¼ ä¸é€šè¿‡ï¼Œæ‰€ä»¥è‚¯å®šè¦æœ‰å®Œæ•´çš„å‚æ•°æ‰ç»™é€šè¿‡ï¼Œæ‰€ä»¥å¤šç”¨åœ¨å‡½æ•°ç›¸äº’è°ƒç”¨ä¹‹é—´
    val set1 : setflod = setflod("fdsjk",32432.4)
    print(set1)
}

//æ¥ä¸‹æ¥æ˜¯withå‡½æ•°çš„ä½¿ç”¨ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç 
fun main3(){
    var list =listOf("apple","banana","orange","pear","grape")
    var builder = StringBuilder()
    builder.append("start eating fruit.\n")
    for(fruit in list){
        builder.append(fruit).append("\n")
    }
    builder.append("all fruit ate")
    val result = builder.toString()
    println(result)
    //withå‡½æ•°ä¼šåœ¨Lambdaè¡¨è¾¾å¼ä¸­æä¾›ç¬¬ä¸€ä¸ªå‚æ•°å¯¹è±¡çš„ä¸Šä¸‹æ–‡ï¼Œ
	//å¹¶ä½¿ç”¨Lambdaè¡¨è¾¾å¼ä¸­çš„æœ€åä¸€è¡Œä»£ç ä½œä¸ºè¿”å›å€¼è¿”å›ï¼Œ
	//æ‰€ä»¥ä¸Šé¢çš„ä»£ç å¯ä»¥ç®€å†™æˆä¸‹é¢è¿™æ ·
    val result2 = with(StringBuilder()){
        append("start eat fruit\n")
        for(fruit in list){
            append(fruit).append("\n")
        }
        append("end")
        toString()
    }
	println(result2)
    //å†æ¥ä¸‹æ¥å°±æ˜¯runå‡½æ•°çš„ä½¿ç”¨ï¼Œè¿™ä¸ªå’Œwithå·®ä¸å¤šï¼Œ
    //ä¸è¿‡ä»–æ˜¯è¢«å¯¹è±¡è°ƒç”¨ï¼Œæ‰€ä»¥ä¸ä¼ å…¥å¯¹è±¡ã€‚ç›´æ¥è·Ÿä¸€ä¸ªlambdaè¡¨è¾¾å¼
    val result3 = StringBuilder().run{
        append("start eat fruit again\n")
        for(fruit in list){
            append(fruit).append("\n")
        }
        append("end again")
        toString()
    }
    //ä½†æ˜¯ä¸Šé¢è¿™ä¸ªä¼šæ˜¾ç¤ºresult3æ²¡æœ‰å®‰å…¨æ£€æŸ¥ã€‚æ‰€ä»¥æœ‰ä»€ä¹ˆæ–¹å¼æ£€æŸ¥å‘¢ï¼Ÿ
    //å¯ä»¥è¿™æ ·æ”¹
    val result4 = StringBuilder().run{
        append("start eat fruit again\n")
        for(fruit in list){
            append(fruit).append("\n")
        }
        append("end again")
        toString()
    }.let{
        if(it.isNotEmpty()){
            println("string is empty")
        }
        else {
            println("fdjkaf")
        }
    }
    //applyåŸºæœ¬å’Œrunä¸€è‡´ï¼Œåªæ˜¯æ²¡åŠæ³•è®¾å®šè¿”å›å€¼ï¼Œè¿”å›å¯¹è±¡æœ¬èº«
    val list2 = listOf("Apple", "Banana", "Orange", "Pear", "Grape")
	val result5 = StringBuilder().apply {
    	append("Start eating fruits.\n")
    	for (fruit in list2) {
        	append(fruit).append("\n")
    }
    	append("Ate all fruits.")
	}
	println(result5.toString())

}

//Kotlinä½¿ç”¨äº†å•ä¾‹ç±»æ¥å¤§éƒ¨åˆ†æ›¿æ¢äº†javaä¸­çš„é™æ€æ–¹æ³•
//ï¼ˆæ·»åŠ staticåä¸éœ€è¦åˆ›å»ºå®ä¾‹å°±å¯ä»¥è°ƒç”¨çš„æ–¹æ³•ï¼‰ï¼Œ
//ä¸è¿‡æƒ³è¦åœ¨Kotlinä¸­åˆ›å»ºçœŸæ­£çš„é™æ€æ–¹æ³•ï¼Œå¯ä»¥åŠ ä¸Š@JvmStatic
class Util {
    fun doAction1(){
        println("do")
    }
    companion object{
        fun doAction2(){
            println("do 2")
        }
    }
}
fun main(){
    //è°ƒç”¨ä¸‹å•ä¾‹ç±»
    Util.doAction2()
}

å…³äºå¦‚ä½•çŸ¥æ™“æ´»åŠ¨çš„Activityï¼š
ä¸€ä¸ªç®€å•çš„çš„Kotlinç±»
open class BaseActivity : AppCompatActivity() {

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        Log.d("BaseActivity", javaClass.simpleName)
    }

}

æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦è®©BaseActivityæˆä¸ºActivityTesté¡¹ç›®ä¸­æ‰€æœ‰Activityçš„çˆ¶ç±»ï¼Œ
ä¸ºäº†ä½¿BaseActivityå¯ä»¥è¢«ç»§æ‰¿ï¼Œæˆ‘å·²ç»æå‰åœ¨ç±»åçš„å‰é¢åŠ ä¸Šäº†openå…³é”®å­—ã€‚ 
ç„¶åä¿®æ”¹FirstActivityã€SecondActivityå’ŒThirdActivityçš„ç»§æ‰¿ç»“æ„ï¼Œè®©å®ƒä»¬ä¸å†ç»§æ‰¿è‡ªAppCompatActivityï¼Œè€Œæ˜¯ç»§æ‰¿è‡ªBaseActivityã€‚ 
è€Œç”±äºBaseActivityåˆæ˜¯ç»§æ‰¿è‡ªAppCompatActivityçš„ï¼Œæ‰€ä»¥é¡¹ç›®ä¸­æ‰€æœ‰Activityçš„ç°æœ‰åŠŸèƒ½å¹¶ä¸å—å½±å“ï¼Œå®ƒä»¬ä»ç„¶ç»§æ‰¿äº†Activityä¸­çš„æ‰€æœ‰ç‰¹æ€§ã€‚ 

3.6.2ã€€éšæ—¶éšåœ°é€€å‡ºç¨‹åº
å…¶å®è§£å†³æ€è·¯ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦ç”¨ä¸€ä¸ªä¸“é—¨çš„é›†åˆå¯¹æ‰€æœ‰çš„Activityè¿›è¡Œç®¡ç†å°±å¯ä»¥äº†ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥å®ç°ä¸€ä¸‹
æ–°å»ºä¸€ä¸ªå•ä¾‹ç±»ActivityCollectorä½œä¸ºActivityçš„é›†åˆï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤º

object ActivityCollector {

    private val activities = ArrayList<Activity>()

    fun addActivity(activity: Activity) {
        activities.add(activity)
    }

    fun removeActivity(activity: Activity) {
        activities.remove(activity)
    }

    fun finishAllï¼ˆï¼‰ {
        for (activity in activities) {
            if (!activity.isFinishing) {
                activity.finish()
            }
        }
        æ´»åŠ¨.clearï¼ˆï¼‰
    }

}

æ¥ä¸‹æ¥ä¿®æ”¹BaseActivityä¸­çš„ä»£ç 
open class BaseActivity : AppCompatActivity() {

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        Log.d("BaseActivity", javaClass.simpleName)
        ActivityCollector.addActivity(this)
    }

    override fun onDestroy() {
        super.onDestroyï¼ˆï¼‰ ä¸­
        ActivityCollector.removeActivity(this)
    }

}

è¿™é‡Œä½¿ç”¨äº†å•ä¾‹ç±»ï¼Œæ˜¯å› ä¸ºå…¨å±€åªéœ€è¦ä¸€ä¸ªActivityé›†åˆ
æ³¨æ„åœ¨é”€æ¯Activityä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè°ƒç”¨activity.isFinishingæ¥åˆ¤æ–­Activityæ˜¯å¦æ­£åœ¨é”€æ¯ä¸­ï¼Œ
å› ä¸ºActivityè¿˜å¯èƒ½é€šè¿‡æŒ‰ä¸‹Backé”®ç­‰æ–¹å¼è¢«é”€æ¯ï¼Œ
å¦‚æœè¯¥Activityæ²¡æœ‰æ­£åœ¨é”€æ¯ä¸­ï¼Œæˆ‘ä»¬å†å»è°ƒç”¨å®ƒçš„finish()æ–¹æ³•æ¥é”€æ¯å®ƒã€‚
ä»æ­¤ä»¥åï¼Œä¸ç®¡ä½ æƒ³åœ¨ä»€ä¹ˆåœ°æ–¹é€€å‡ºç¨‹åºï¼Œåªéœ€è¦è°ƒç”¨ActivityCollector.finishAll()æ–¹æ³•å°±å¯ä»¥äº†


3.6.3ã€€å¯åŠ¨Activityçš„æœ€ä½³å†™æ³•
å°†å‚æ•°æš´éœ²å‡ºæ¥å‡å°‘æ²Ÿé€šæˆæœ¬å’Œçœ‹ä»£ç çš„æˆæœ¬
åˆ†å·¥æ—¶å¯èƒ½ä¸€ä¸ªäººè´Ÿè´£ä¸€ä¸ªActivityï¼Œå¦‚æœæ˜¯æŒ‰ç…§ä¸‹é¢è¿™æ ·ï¼š
val intent = Intent(this, SecondActivity::class.java)
intent.putExtra("param1", "data1")
intent.putExtraï¼ˆâ€œå‚æ•°2â€ï¼Œ â€œæ•°æ®2â€ï¼‰
startActivity(intent)

ä¸‹ä¸€ä¸ªæ¥ä»»è€…åªèƒ½çœ‹ä»£ç æˆ–è€…é—®ä½ æ‰çŸ¥é“è°ƒç”¨çš„å‚æ•°
æ›´å¥½çš„å†™æ³•æ˜¯é™æ€æ–¹æ³•
class SecondActivity : BaseActivity() {
    ...
    companion object {
        fun actionStart(context: Context, data1: String, data2: String) {
            val intent = Intent(context, SecondActivity::class.java)
            intent.putExtra("param1", data1)
            intent.putExtra("param2", data2)
            context.startActivity(intent)
        }
    }
}
ä½¿ç”¨ä¸€ä¸ªé™æ€æ–¹æ³•Companion Object å°†å¯åŠ¨çš„ä»£ç æ‰“åŒ…æˆä¸€ä¸ªå‡½æ•°ï¼Œæš´éœ²å‡ºéœ€è¦ä¼ å…¥çš„å‚æ•°
è¿™æ ·å°±ä¸å¿…å› ä¸ºä¸çŸ¥é“å‚æ•°å¯¼è‡´å¯¹æ¥æœ‰å›°éš¾
è°ƒç”¨å…¶ä»–äººå†™çš„Activityåªéœ€è¦è¿™æ ·åš
button1.setOnClickListener {
    SecondActivity.actionStartï¼ˆthisï¼Œ â€œæ•°æ®1â€ï¼Œ â€œæ•°æ®2â€ï¼‰
}

é«˜é˜¶å‡½æ•°

withç”¨æ³•ï¼š
val result = with(obj) {
    // è¿™é‡Œæ˜¯objçš„ä¸Šä¸‹æ–‡
    "value" // withå‡½æ•°çš„è¿”å›å€¼
}


æ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼š
val list = listOf("Apple", "Banana", "Orange", "Pear", "Grape")
val result = with(StringBuilder()) {
    append("Start eating fruits.\n")
    for (fruit in list) {
        append(fruit).append("\n")
    }
    append("Ate all fruits.")
    toString()
}
println(result)

é¦–å…ˆæˆ‘ä»¬ç»™withå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥äº†ä¸€ä¸ªStringBuilderå¯¹è±¡ï¼Œ
é‚£ä¹ˆæ¥ä¸‹æ¥æ•´ä¸ªLambdaè¡¨è¾¾å¼çš„ä¸Šä¸‹æ–‡å°±ä¼šæ˜¯è¿™ä¸ªStringBuilderå¯¹è±¡ã€‚ï¼ˆåŸæ¥ä¸Šä¸‹æ–‡è¿™ä¸ªæ„æ€ï¼‰
äºæ˜¯æˆ‘ä»¬åœ¨Lambdaè¡¨è¾¾å¼ä¸­å°±ä¸ç”¨å†åƒåˆšæ‰é‚£æ ·è°ƒç”¨builder.append()å’Œbuilder.toString()æ–¹æ³•äº†ï¼Œè€Œæ˜¯å¯ä»¥ç›´æ¥è°ƒç”¨append()å’ŒtoString()æ–¹æ³•ã€‚
Lambdaè¡¨è¾¾å¼çš„æœ€åä¸€è¡Œä»£ç ä¼šä½œä¸ºwithå‡½æ•°çš„è¿”å›å€¼è¿”å›ï¼Œæœ€ç»ˆæˆ‘ä»¬å°†ç»“æœæ‰“å°å‡ºæ¥ã€‚

é¦–å…ˆrunå‡½æ•°é€šå¸¸ä¸ä¼šç›´æ¥è°ƒç”¨ï¼Œè€Œæ˜¯è¦åœ¨æŸä¸ªå¯¹è±¡çš„åŸºç¡€ä¸Šè°ƒç”¨ï¼›
å…¶æ¬¡runå‡½æ•°åªæ¥æ”¶ä¸€ä¸ªLambdaå‚æ•°ï¼Œå¹¶ä¸”ä¼šåœ¨Lambdaè¡¨è¾¾å¼ä¸­æä¾›è°ƒç”¨å¯¹è±¡çš„ä¸Šä¸‹æ–‡
å…¶ä»–æ–¹é¢å’Œwithå‡½æ•°æ˜¯ä¸€æ ·çš„ï¼ŒåŒ…æ‹¬ä¹Ÿä¼šä½¿ç”¨Lambdaè¡¨è¾¾å¼ä¸­çš„æœ€åä¸€è¡Œä»£ç ä½œä¸ºè¿”å›å€¼è¿”å›
val result = obj.run {
    // è¿™é‡Œæ˜¯objçš„ä¸Šä¸‹æ–‡
    "value" // runå‡½æ•°çš„è¿”å›å€¼
}

ä½¿ç”¨runå®ç°å’Œwithç›¸åŒçš„åŠŸèƒ½ï¼š
val list = listOf("Apple", "Banana", "Orange", "Pear", "Grape")
val result = StringBuilder().run {
    append("Start eating fruits.\n")
    for (fruit in list) {
        append(fruit).append("\n")
    }
    append("Ate all fruits.")
    toString()
}
println(result)

å…¶å®æ²¡æœ‰ä»€ä¹ˆå¾ˆå¤§çš„åŒºåˆ«
æ€»ä½“æ¥è¯´å˜åŒ–éå¸¸å°ï¼Œåªæ˜¯å°†è°ƒç”¨withå‡½æ•°å¹¶ä¼ å…¥StringBuilderå¯¹è±¡æ”¹æˆäº†è°ƒç”¨StringBuilderå¯¹è±¡çš„runæ–¹æ³•ï¼Œå…¶ä»–éƒ½æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œ
è¿™ä¸¤æ®µä»£ç æœ€ç»ˆçš„æ‰§è¡Œç»“æœæ˜¯å®Œå…¨ç›¸åŒçš„ã€‚

æœ€åæˆ‘ä»¬å†æ¥å­¦ä¹ æ ‡å‡†å‡½æ•°ä¸­çš„applyå‡½æ•°ã€‚applyå‡½æ•°å’Œrunå‡½æ•°ä¹Ÿæ˜¯æå…¶ç±»ä¼¼çš„ï¼Œéƒ½è¦åœ¨æŸä¸ªå¯¹è±¡ä¸Šè°ƒç”¨ï¼Œå¹¶ä¸”åªæ¥æ”¶ä¸€ä¸ªLambdaå‚æ•°ï¼Œ
ä¹Ÿä¼šåœ¨Lambdaè¡¨è¾¾å¼ä¸­æä¾›è°ƒç”¨å¯¹è±¡çš„ä¸Šä¸‹æ–‡ï¼Œä½†æ˜¯applyå‡½æ•°æ— æ³•æŒ‡å®šè¿”å›å€¼ï¼Œè€Œæ˜¯ä¼šè‡ªåŠ¨è¿”å›è°ƒç”¨å¯¹è±¡æœ¬èº«
val result = obj.apply {
     // è¿™é‡Œæ˜¯objçš„ä¸Šä¸‹æ–‡
}
ç»“æœ == OBJ

val list = listOf("Apple", "Banana", "Orange", "Pear", "Grape")
val result = StringBuilder().apply {
    append("Start eating fruits.\n")
    for (fruit in list) {
        append(fruit).append("\n")
    }
    append("Ate all fruits.")
}
printlnï¼ˆresult.toStringï¼ˆï¼‰ï¼‰

è¿™æ—¶å€™è°ƒç”¨çš„æ˜¯è¿”å›åçš„StringBuilderå¯¹è±¡çš„tostring æ–¹æ³•

å›æƒ³ä¸€ä¸‹åˆšåˆšåœ¨æœ€ä½³å®è·µç¯èŠ‚ç¼–å†™çš„å¯åŠ¨Activityçš„ä»£ç ï¼š
val intent = Intent(context, SecondActivity::class.java)
intent.putExtra("param1", "data1")
intent.putExtra("param2", "data2")
context.startActivityï¼ˆæ„å›¾ï¼‰

æ˜¾ç„¶è¿™é‡Œçš„intentå¯¹è±¡å¯ä»¥ä½¿ç”¨é«˜é˜¶å‡½æ•°è¿›è¡Œç®€åŒ–
val intent = Intent(context, SecondActivity::class.java).apply {
    putExtra("param1", "data1")
    putExtra("param2", "data2")
}
context.startActivityï¼ˆæ„å›¾ï¼‰


é™æ€æ–¹æ³•ä¸å•ä¾‹ç±»
Kotlinæä¾›äº†æ¯”é™æ€æ–¹æ³•æ›´å¥½ç”¨çš„è¯­æ³•ç‰¹æ€§ï¼Œå¹¶ä¸”æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚ä¸­å·²ç»å­¦ä¹ è¿‡äº†ï¼Œé‚£å°±æ˜¯å•ä¾‹ç±»ã€‚
å°†classæ›¿æ¢ä¸ºObject
object Util {

    fun doAction() {
        println("do action")
    }

}
å¦‚æœæˆ‘ä»¬ä¸æƒ³è®©æ•´ä¸ªç±»é‡Œé¢çš„å‡½æ•°éƒ½å˜æˆé™æ€æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨companion Object
class Util {

    fun doAction1() {
        println("do action1")
    }

    companion object {

        fun doAction2() {
            println("do action2")
        }

    }

}
doAction2()æ–¹æ³•å¯ä»¥ç›´æ¥ä½¿ç”¨Util.doAction2()çš„æ–¹å¼è°ƒç”¨ã€‚ 

è€Œå¦‚æœæˆ‘ä»¬ç»™å•ä¾‹ç±»æˆ–companion objectä¸­çš„æ–¹æ³•åŠ ä¸Š@JvmStaticæ³¨è§£ï¼Œé‚£ä¹ˆKotlinç¼–è¯‘å™¨å°±ä¼šå°†è¿™äº›æ–¹æ³•ç¼–è¯‘æˆçœŸæ­£çš„é™æ€æ–¹æ³•
å¦‚æœæ˜¯åœ¨Kotlinä»£ç ä¸­è°ƒç”¨çš„è¯ï¼Œé‚£å°±å¾ˆç®€å•äº†ï¼Œæ‰€æœ‰çš„é¡¶å±‚æ–¹æ³•éƒ½å¯ä»¥åœ¨ä»»ä½•ä½ç½®è¢«ç›´æ¥è°ƒç”¨ï¼Œä¸ç”¨ç®¡åŒ…åè·¯å¾„ï¼Œ
ä¹Ÿä¸ç”¨åˆ›å»ºå®ä¾‹ï¼Œç›´æ¥é”®å…¥doSomething()å³å¯
class Util {

    fun doAction1() {
        println("do action1")
    }

    companion object {

        @JvmStatic
        fun doAction2() {
            println("do action2")
        }

    }

}
